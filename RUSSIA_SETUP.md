# üá∑üá∫ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NakamaSpace –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –†–æ—Å—Å–∏–∏

## üö® –ü—Ä–æ–±–ª–µ–º–∞
API e621, Danbooru –∏ Gelbooru –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –≤ –†–æ—Å—Å–∏–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–æ–∏—Å–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
- **–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø**: –ï—Å–ª–∏ API –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞–ø—Ä—è–º—É—é - –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö
- **–ü—Ä–æ–∫—Å–∏ —Ä–µ–∂–∏–º**: –ï—Å–ª–∏ API –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã - –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- **–õ–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç**: –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### üåê –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

#### –î–ª—è —Ñ—É—Ä—Ä–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:
1. **e621** (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
2. **Rule34** (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
3. **–õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã** (–∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)

#### –î–ª—è –∞–Ω–∏–º–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:
1. **Danbooru** (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
2. **Gelbooru** (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)
3. **Safebooru** (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
4. **–õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã** (–∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
npm run install-all
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```bash
# –°–æ–∑–¥–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è-–∑–∞–≥–ª—É—à–∫–∏
node backend/scripts/setup-default-images.js
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –û–±–Ω–æ–≤–∏—Ç–µ .env —Ñ–∞–π–ª
nano backend/.env
```

–î–æ–±–∞–≤—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–∫—Å–∏:
```env
# –ü—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
PROXY_HOST=your-proxy-host.com
PROXY_PORT=8080
PROXY_USERNAME=proxy_user
PROXY_PASSWORD=proxy_password

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ API
RULE34_ENABLED=true
SAFEBOORU_ENABLED=true
LOCAL_SEARCH_ENABLED=true
```

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 restart nakama-space-backend

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏
pm2 logs nakama-space-backend --lines 20
```

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
1. –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ API
2. –ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –ø—Ä–æ–∫—Å–∏ —Ä–µ–∂–∏–º
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–µ–∂–∏–º–µ —Ä–∞–±–æ—Ç—ã

### Fallback —Å–∏—Å—Ç–µ–º–∞
```
e621/Danbooru/Gelbooru (–ø—Ä—è–º–æ–π)
    ‚Üì (–µ—Å–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã)
Rule34/Safebooru (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ)
    ‚Üì (–µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã)
–õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã (–∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
    ‚Üì (–µ—Å–ª–∏ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤)
–î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è-–∑–∞–≥–ª—É—à–∫–∏
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 30 –º–∏–Ω—É—Ç
- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ–≥–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–æ–∫
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫—ç—à–∏—Ä—É—é—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º

## üì± –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞
- **üîÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API...** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
- **üåê –†–µ–∂–∏–º –¥–ª—è –†–æ—Å—Å–∏–∏** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- **‚úÖ –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø** - –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ –ø—Ä–æ–∫—Å–∏ —Ä–µ–∂–∏–º–µ
- **E621 (–§—É—Ä—Ä–∏)** ‚Üí Rule34 + –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã
- **Danbooru (–ê–Ω–∏–º–µ)** ‚Üí Safebooru + –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã  
- **Gelbooru (–ê–Ω–∏–º–µ)** ‚Üí Safebooru + –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- ‚úÖ –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±–æ–π —Å—Ç—Ä–∞–Ω–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –æ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
- ‚úÖ Fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ API
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API
curl -I https://e621.net/posts.json
curl -I https://danbooru.donmai.us/posts.json
curl -I https://gelbooru.com/index.php

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ API
curl -I https://api.rule34.xxx/index.php
curl -I https://safebooru.org/index.php
```

### –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏ –ø–æ–∏—Å–∫–∞
pm2 logs nakama-space-backend | grep -i "search\|proxy\|api"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫–∏
pm2 logs nakama-space-backend | grep -i "error"
```

## üöÄ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Å–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä, –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–≥–æ:

```javascript
// –í backend/routes/proxy-search.js
const proxyConfig = {
  host: process.env.PROXY_HOST,
  port: process.env.PROXY_PORT,
  auth: {
    username: process.env.PROXY_USERNAME,
    password: process.env.PROXY_PASSWORD
  }
};
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
–ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ API:

```javascript
// –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≤ proxy-search.js
const searchNewSource = async (query, page = 1) => {
  try {
    const response = await axios.get('https://new-source.com/api', {
      params: { q: query, page },
      ...createProxyConfig()
    });
    return response.data.map(item => ({
      // –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
    }));
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –Ω–æ–≤–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞:', error);
    return [];
  }
};
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç:
- –ö–∞–∫–æ–π API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–∞—â–µ
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ fallback'–æ–≤
- –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### –ú–µ—Ç—Ä–∏–∫–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å:
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –≤–Ω–µ—à–Ω–∏–º API

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å NakamaSpace —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∞—Ö:

- **üá∫üá∏ –°–®–ê/–ï–≤—Ä–æ–ø–∞**: –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ e621, Danbooru, Gelbooru
- **üá∑üá∫ –†–æ—Å—Å–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- **üåç –î—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω—ã**: –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –†–æ—Å—Å–∏–∏ –ø–æ–ª—É—á–∞—é—Ç –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π!** üöÄ
